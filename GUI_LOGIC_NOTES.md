# GUI Loader Notes
- `GuiLoadDefinition` (`0x004aa8f0`) uses the generic TDF stack: it opens the `.GUI` entry through `ResourceOpen` (`FUN_004bb5b0`), reads the payload with `FUN_004bb7c0`, then hands the decoded buffer to `TdfLoadFile`.  
- `TdfLoadFile` (renamed at `0x004c2f60`) allocates a temporary block, requests the raw bytes from the resource handle, applies the archive per-byte transform (`~byte ^ key ^ (offset + index)`), strips comments via `TdfStripComments` (`0x004c33a0`), and finally feeds the text to `TdfParseBuffer` so that GUI metadata is consumed as ordinary TDF sections.
- The resource reader `FUN_004bb7c0` handles both raw and SQSH-packed blobs: it pulls chunk metadata from the handle, uses the same XOR scheme with the per-entry key stored at `handle->info[0xC]`, and, when the chunked flag (`piVar6[2] != 0`) is set, inflates each 0x10000 block through `FUN_004d1970` before copying it into the caller’s buffer.
- Raw `.GUI` assets start with the ASCII header `[GEDGIZ@a` and are otherwise dense binary; even after undoing the archive XOR they do not expose plain-text keys, implying a compiled TDF layout where identifiers are encoded (lookups later go through hashed-name helpers such as `FUN_004c46c0`/`FUN_004c48c0`).
- The `SQSH` chunk “encrypted” flag is significant: the engine (and cosmouser’s Go extractor) undo it with `byte_i = i & 0xFF; plain = (cipher - byte_i) ^ byte_i`. Respecting that per-byte tweak converts the `[GEDGIZ@a…]` blocks back into human-readable `[GADGET…]` TDF text.
